#!/bin/bash

repositoryUrl=`git remote get-url origin 2> /dev/null`

if [[ $repositoryUrl == "" ]]
then
    exit 0
fi

repositoryUrlBasename=`basename "$repositoryUrl"`
repository=`echo "$repositoryUrlBasename" | sed -E 's/(.+?)\.git$/\1/'`

if [[ $repository == "" ]]
then
	exit 0
fi

branch=$(git rev-parse --abbrev-ref HEAD 2>/dev/null)

nAheadText=
nBehindText=
nAhead=$(git rev-list --count @{u}..HEAD 2>/dev/null)
if [ "$?" == "0" ]
then
	if [ "$nAhead" != "0" ]
	then
		nAheadText="+$nAhead"
	fi

	nBehind=$(git rev-list --count HEAD..@{u} 2>/dev/null)
	if [ "$nBehind" != "0" ]
	then
		nBehindText="-$nBehind"
	fi
fi

# Σ
echo -n  "\[\e[1;34m\]Σ $repository > $branch\[\e[2;93m\]$nAheadText\[\e[96m\]$nBehindText\[\e[0m\] "
